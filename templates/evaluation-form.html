{% extends "base.html" %}

{% block title %}Submit Volunteer Evaluation{% endblock %}

{% block content %}
<div class="evaluation-form-container">
    <h1>Volunteer Performance Evaluation</h1>
    <p class="subtitle">Please take a moment to provide feedback on your experience working with our volunteers.</p>

    <form method="POST" action="{{ url_for('evaluation.submit_evaluation') }}" class="evaluation-form">
        <!-- SECTION 1: Volunteer Information -->
        <section class="form-section">
            <h2>Volunteer Information</h2>
            
            <div class="form-group">
                <label for="volunteer_id">Select Volunteer *</label>
                <select id="volunteer_id" name="volunteer_id" required>
                    <option value="">-- Select a volunteer --</option>
                    {% for volunteer in volunteers %}
                    <option value="{{ volunteer.id }}">
                        {{ volunteer.first_name }} {{ volunteer.last_name }}
                    </option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label for="role_performed">Role Performed *</label>
                <select id="role_performed" name="role_performed" required>
                    <option value="">-- Select role performed --</option>
                    <option value="GL">GL</option>
                    <option value="GLA">GLA</option>
                    <option value="GG">GG</option>
                    <option value="Doors">Doors</option>
                    <option value="RR">RR</option>
                    <option value="HST">HST</option>
                    <option value="HSL">HSL</option>
                    <option value="FTVL">FTVL</option>
                    <option value="Medical">Medical</option>
                    <option value="Door Lead">Door Lead</option>
                    <option value="RR Lead">RR Lead</option>
                    <option value="Medical Lead">Medical Lead</option>
                    <option value="GC Lead">GC Lead</option>
                </select>
            </div>

            <div class="form-group">
                <label for="event_name">Event Name *</label>
                <select id="event_name" name="event_name" required>
                    <option value="">-- Select event --</option>
                    <option value="WLR">WLR</option>
                    <option value="AFU">AFU</option>
                    <option value="Prog">Prog</option>
                    <option value="10-Day">10-Day</option>
                    <option value="Other">Other</option>
                </select>
            </div>

            <div class="form-row">
                <div class="form-group form-group-half">
                    <label for="service_month">Month of Service *</label>
                    <select id="service_month" name="service_month" required>
                        <option value="">-- Month --</option>
                        <option value="01">January</option>
                        <option value="02">February</option>
                        <option value="03">March</option>
                        <option value="04">April</option>
                        <option value="05">May</option>
                        <option value="06">June</option>
                        <option value="07">July</option>
                        <option value="08">August</option>
                        <option value="09">September</option>
                        <option value="10">October</option>
                        <option value="11">November</option>
                        <option value="12">December</option>
                    </select>
                </div>

                <div class="form-group form-group-half">
                    <label for="service_year">Year of Service *</label>
                    <select id="service_year" name="service_year" required>
                        <option value="">-- Year --</option>
                        <option value="2025">2025</option>
                        <option value="2024">2024</option>
                        <option value="2023">2023</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label for="evaluation_date">Date of Evaluation *</label>
                <input type="date" id="evaluation_date" name="evaluation_date" required>
            </div>
        </section>

        <section class="form-section">
            <h2>Performance Ratings</h2>
            <p class="rating-guide">Rate each category from 1 (Needs Improvement) to 10 (Excellent)</p>

            <div class="slider-group">
                <label for="reliability">Reliability * <span class="rating-display">(Current: <output for="reliability" class="rating-number">7</output>/10)</span></label>
                <p class="rating-description">Punctuality, attendance, follows through on commitments</p>
                <div class="slider-container">
                    <span class="slider-label">1</span>
                    <input type="range" name="reliability" id="reliability" min="1" max="10" value="7" required>
                    <span class="slider-label">10</span>
                </div>
            </div>

            <div class="slider-group">
                <label for="quality_of_work">Quality of Work * <span class="rating-display">(Current: <output for="quality_of_work" class="rating-number">7</output>/10)</span></label>
                <p class="rating-description">Attention to detail, accuracy, thoroughness</p>
                <div class="slider-container">
                    <span class="slider-label">1</span>
                    <input type="range" name="quality_of_work" id="quality_of_work" min="1" max="10" value="7" required>
                    <span class="slider-label">10</span>
                </div>
            </div>

            <div class="slider-group">
                <label for="initiative">Initiative * <span class="rating-display">(Current: <output for="initiative" class="rating-number">7</output>/10)</span></label>
                <p class="rating-description">Proactiveness, problem-solving, self-direction</p>
                <div class="slider-container">
                    <span class="slider-label">1</span>
                    <input type="range" name="initiative" id="initiative" min="1" max="10" value="7" required>
                    <span class="slider-label">10</span>
                </div>
            </div>

            <div class="slider-group">
                <label for="teamwork">Teamwork * <span class="rating-display">(Current: <output for="teamwork" class="rating-number">7</output>/10)</span></label>
                <p class="rating-description">Collaboration, supportiveness, adaptability</p>
                <div class="slider-container">
                    <span class="slider-label">1</span>
                    <input type="range" name="teamwork" id="teamwork" min="1" max="10" value="7" required>
                    <span class="slider-label">10</span>
                </div>
            </div>

            <div class="slider-group">
                <label for="communication">Communication * <span class="rating-display">(Current: <output for="communication" class="rating-number">7</output>/10)</span></label>
                <p class="rating-description">Clarity, responsiveness, professionalism</p>
                <div class="slider-container">
                    <span class="slider-label">1</span>
                    <input type="range" name="communication" id="communication" min="1" max="10" value="7" required>
                    <span class="slider-label">10</span>
                </div>
            </div>

            <!-- Overall Average -->
            <div class="overall-rating">
                <div class="overall-rating-label">Overall Average:</div>
                <div class="overall-rating-value" id="overall-average">7.0</div>
            </div>
        </section>

        <script>
        // Update slider output values and calculate average
        function updateAverage() {
            const sliders = document.querySelectorAll('input[type="range"]');
            let sum = 0;
            sliders.forEach(slider => {
                sum += parseInt(slider.value);
            });
            const average = (sum / sliders.length).toFixed(1);
            document.getElementById('overall-average').textContent = average;
        }

        document.querySelectorAll('input[type="range"]').forEach(slider => {
            const sliderId = slider.id;
            const output = document.querySelector(`output[for="${sliderId}"]`);
            if (output) {
                slider.addEventListener('input', (e) => {
                    output.textContent = e.target.value;
                    updateAverage();
                });
            }
        });
        </script>

        <!-- SECTION 3: Qualitative Feedback -->
        <section class="form-section">
            <h2>Qualitative Feedback</h2>

            <div class="form-group">
                <label for="strengths">What are this volunteer's key strengths?</label>
                <textarea id="strengths" name="strengths" rows="4"></textarea>
            </div>

            <div class="form-group">
                <label for="areas_for_improvement">What areas could this volunteer improve?</label>
                <textarea id="areas_for_improvement" name="areas_for_improvement" rows="4"></textarea>
            </div>

            <div class="form-group">
                <label for="additional_comments">Additional Comments</label>
                <textarea id="additional_comments" name="additional_comments" rows="4"></textarea>
            </div>
        </section>

        <!-- SECTION 4: Evaluator Information (AT THE END) -->
        <section class="form-section">
            <h2>Your Information</h2>
            
            <div class="form-group">
                <label for="evaluator_name">Your Name *</label>
                <input type="text" id="evaluator_name" name="evaluator_name" required>
            </div>

            <div class="form-group">
                <label for="evaluator_email">Your Email</label>
                <input type="email" id="evaluator_email" name="evaluator_email">
            </div>

            <div class="form-group">
                <label for="evaluator_role">Your Role *</label>
                <select id="evaluator_role" name="evaluator_role" required>
                    <option value="">-- Select your role --</option>
                    <option value="GL">GL</option>
                    <option value="GLA">GLA</option>
                    <option value="GG">GG</option>
                    <option value="Doors">Doors</option>
                    <option value="RR">RR</option>
                    <option value="HST">HST</option>
                    <option value="HSL">HSL</option>
                    <option value="FTVL">FTVL</option>
                    <option value="Medical">Medical</option>
                    <option value="Door Lead">Door Lead</option>
                    <option value="RR Lead">RR Lead</option>
                    <option value="Medical Lead">Medical Lead</option>
                    <option value="GC Lead">GC Lead</option>
                </select>
            </div>
        </section>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Submit Evaluation</button>
        </div>
    </form>
</div>

<!-- Success Modal -->
<div id="successModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <span class="success-icon">âœ“</span>
            <h2>Evaluation Submitted Successfully!</h2>
        </div>
        <div class="modal-body">
            <p>Thank you for taking the time to evaluate this volunteer.</p>
            <p>Your feedback has been recorded and will help improve our volunteer program.</p>
        </div>
        <div class="modal-footer">
            <button onclick="closeModal()" class="btn btn-primary">Close</button>
        </div>
    </div>
</div>

<style>
/* Modal Styles */
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
}

.modal.active {
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.3s ease;
}

.modal-content {
    background: white;
    border-radius: 16px;
    padding: 2rem;
    max-width: 500px;
    width: 90%;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    animation: slideUp 0.3s ease;
}

.modal-header {
    text-align: center;
    margin-bottom: 1.5rem;
}

.success-icon {
    display: inline-block;
    width: 80px;
    height: 80px;
    line-height: 80px;
    font-size: 48px;
    color: white;
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    border-radius: 50%;
    margin-bottom: 1rem;
}

.modal-header h2 {
    color: var(--text-primary);
    margin: 0;
}

.modal-body {
    text-align: center;
    margin-bottom: 2rem;
}

.modal-body p {
    color: var(--text-secondary);
    margin: 0.5rem 0;
}

.modal-footer {
    text-align: center;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slideUp {
    from {
        transform: translateY(30px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}
</style>
{% endblock %}
